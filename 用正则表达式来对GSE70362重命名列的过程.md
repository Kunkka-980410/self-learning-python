## GSE70362一般处理过后的列名
是以GSM样本名来命名的列
```text
"GSM1725780"	"GSM1725781"	"GSM1725782"	"GSM1725783"	"GSM1725784"	"GSM1725785"	"GSM1725786"	"GSM1725787"
"GSM1725788"	"GSM1725789"	"GSM1725790"	"GSM1725791"	"GSM1725792"	"GSM1725793"	"GSM1725794"	"GSM1725795"
"GSM1725796"	"GSM1725797"	"GSM1725798"	"GSM1725799"	"GSM1725800"	"GSM1725801"	"GSM1725802"	"GSM1725803"
"GSM1725804"	"GSM1725805"	"GSM1725806"	"GSM1725807"	"GSM1725808"	"GSM1725809"	"GSM1725810"	"GSM1725811"
"GSM1725812"	"GSM1725813"	"GSM1725814"	"GSM1725815"	"GSM1725816"	"GSM1725817"	"GSM1725818"	"GSM1725819"
"GSM1725820"	"GSM1725821"	"GSM1725822"	"GSM1725823"	"GSM1725824"	"GSM1725825"	"GSM1725826"	"GSM1725827"
```

但是可能对于后续分类讨论以及统计分析不利，因为需要提取分组，但是GSM样本编号分组信息需要从metadata来对比，并不方便，这时候需要建立映射，或者将GSM样本编号的列重命名

一般来说，最简单的方法是，找到GSM对应的描述，然后直接重命名列

```python
# 设定一个新的对应的列表
new_columns =["Donor1_IVD1_AF"	"Donor1_IVD1_NP"	"Donor1_IVD2_AF"	"Donor1_IVD2_NP"	"Donor2_IVD1_AF"	"Donor2_IVD1_NP"
"Donor2_IVD2_AF"	"Donor2_IVD2_NP"	"Donor3_IVD1_AF"	"Donor3_IVD1_NP"	"Donor3_IVD2_AF"	"Donor3_IVD2_NP"
"Donor4_IVD1_AF"	"Donor4_IVD1_NP"	"Donor4_IVD2_AF"	"Donor4_IVD2_NP"	"Donor5_IVD1_AF"	"Donor5_IVD1_NP"
"Donor5_IVD2_AF"	"Donor5_IVD2_NP"	"Donor6_IVD1_AF"	"Donor6_IVD1_NP"	"Donor6_IVD2_AF"	"Donor6_IVD2_NP"
"Donor7_IVD1_AF"	"Donor7_IVD1_NP"	"Donor8_IVD1_AF"	"Donor8_IVD1_NP"	"Donor9_IVD1_AF"	"Donor9_IVD1_NP"
"Donor11_IVD1_AF"	"Donor11_IVD1_NP"	"Donor70_IVD1_NP"	"Donor70_IVD1_AF"	"Donor81_IVD1_AF"	"Donor81_IVD1_NP"
"Donor100_IVD1_NP"	"Donor100_IVD1_AF"	"Donor106_IVD1_NP"	"Donor106_IVD1_AF"	"Donor136_IVD1_NP"	"Donor136_IVD1_AF"
"Donor147_IVD1_NP"	"Donor147_IVD1_AF"	"Donor172_IVD1_NP"	"Donor172_IVD1_AF"	"Donor246_IVD1_NP"	"Donor246_IVD1_AF"],

# 重命名列
df.columns = new_columns
```

但是有一个小问题，`new_columns`里面并不是逗号，不太能准确映射和合法对应为`df.columns`，此时需要用到正则表达式来给`new_columns`的每个描述加逗号来建立合法映射

## 用正则表达式在输入的字符串之间加逗号分割
```python
import re

# 输入的描述
input_string = '''"Donor1_IVD1_AF" "Donor1_IVD1_NP" "Donor1_IVD2_AF" "Donor1_IVD2_NP" "Donor2_IVD1_AF" "Donor2_IVD1_NP" "Donor2_IVD2_AF" "Donor2_IVD2_NP" "Donor3_IVD1_AF" "Donor3_IVD1_NP" "Donor3_IVD2_AF" "Donor3_IVD2_NP" "Donor4_IVD1_AF" "Donor4_IVD1_NP" "Donor4_IVD2_AF" "Donor4_IVD2_NP" "Donor5_IVD1_AF" "Donor5_IVD1_NP" "Donor5_IVD2_AF" "Donor5_IVD2_NP" "Donor6_IVD1_AF" "Donor6_IVD1_NP" "Donor6_IVD2_AF" "Donor6_IVD2_NP" "Donor7_IVD1_AF" "Donor7_IVD1_NP" "Donor8_IVD1_AF" "Donor8_IVD1_NP" "Donor9_IVD1_AF" "Donor9_IVD1_NP" "Donor11_IVD1_AF" "Donor11_IVD1_NP" "Donor70_IVD1_NP" "Donor70_IVD1_AF" "Donor81_IVD1_AF" "Donor81_IVD1_NP" "Donor100_IVD1_NP" "Donor100_IVD1_AF" "Donor106_IVD1_NP" "Donor106_IVD1_AF" "Donor136_IVD1_NP" "Donor136_IVD1_AF" "Donor147_IVD1_NP" "Donor147_IVD1_AF" "Donor172_IVD1_NP" "Donor172_IVD1_AF" "Donor246_IVD1_NP" "Donor246_IVD1_AF"'''

# 正则表达式内容   
column_names =re.findall(r'"([^"]+")',input_string)  
formatted = ','.join(f'"{name}"' for name in column_names)
print(f'df_columns = [{formatted}]')
```

🧠 代码目的
这段代码的目标是： 从一个原始字符串中提取所有样本名，并格式化成一个合法的 Python 列表字符串，方便后续赋值给 `df.columns` 或用于展示。

🔍 逐行解释
1️⃣ 原始字符串定义
```python
input_string = '''"Donor1_IVD1_AF" "Donor1_IVD1_NP" ...'''
```
这是一个多组样本名的字符串，每个样本名都被双引号包裹，并用空格分隔。
2️⃣ 正则提取字段
```python
column_names = re.findall(r'"([^"]+)"', input_string)
```
这行代码使用正则表达式提取所有双引号内的内容：

`"`：匹配左引号

`([^"]+)`：捕获组，匹配非引号字符（即样本名）

`"`：匹配右引号
结果是一个列表：

```python
['Donor1_IVD1_AF', 'Donor1_IVD1_NP', 'Donor1_IVD2_AF', ...]
```
3️⃣ 格式化为合法列表字符串
```python
formatted = ','.join(f'"{name}"' for name in column_names)
```
这一步是为了把每个样本名重新加上引号，并用逗号连接起来，形成：

```python
'"Donor1_IVD1_AF","Donor1_IVD1_NP","Donor1_IVD2_AF",...'
```
4️⃣ 打印结果
```python
print(f'df_columns = [{formatted}]')
```
最终输出是一个合法的 Python 列表格式：

```python
df_columns = ["Donor1_IVD1_AF", "Donor1_IVD1_NP", "Donor1_IVD2_AF", ...]
```
你可以直接复制粘贴到代码里，用于：
```python
df.columns = df_columns
```
---
另一种代码方法
```python
import re

# 原始字符串（去掉引号）
input_string = '''"Donor1_IVD1_AF" "Donor1_IVD1_NP" "Donor1_IVD2_AF" "Donor1_IVD2_NP" "Donor2_IVD1_AF" "Donor2_IVD1_NP" "Donor2_IVD2_AF" "Donor2_IVD2_NP" "Donor3_IVD1_AF" "Donor3_IVD1_NP" "Donor3_IVD2_AF" "Donor3_IVD2_NP" "Donor4_IVD1_AF" "Donor4_IVD1_NP" "Donor4_IVD2_AF" "Donor4_IVD2_NP" "Donor5_IVD1_AF" "Donor5_IVD1_NP" "Donor5_IVD2_AF" "Donor5_IVD2_NP" "Donor6_IVD1_AF" "Donor6_IVD1_NP" "Donor6_IVD2_AF" "Donor6_IVD2_NP" "Donor7_IVD1_AF" "Donor7_IVD1_NP" "Donor8_IVD1_AF" "Donor8_IVD1_NP" "Donor9_IVD1_AF" "Donor9_IVD1_NP" "Donor11_IVD1_AF" "Donor11_IVD1_NP" "Donor70_IVD1_NP" "Donor70_IVD1_AF" "Donor81_IVD1_AF" "Donor81_IVD1_NP" "Donor100_IVD1_NP" "Donor100_IVD1_AF" "Donor106_IVD1_NP" "Donor106_IVD1_AF" "Donor136_IVD1_NP" "Donor136_IVD1_AF" "Donor147_IVD1_NP" "Donor147_IVD1_AF" "Donor172_IVD1_NP" "Donor172_IVD1_AF" "Donor246_IVD1_NP" "Donor246_IVD1_AF"'''

# 使用正则表达式在引号之间添加逗号
result = re.sub(r'"\s+"', '", "', input_string)

print(result)
df.columns =result  #重命名列
```
```python
# 使用正则表达式在引号之间添加逗号
result = re.sub(r'"\s+"', '", "', input_string)

```
解释：

`re.sub()`：正则表达式替换函数

`r'"\s+"'`：正则表达式模式，匹配：一个双引号 + 一个或多个空白字符 + 一个双引号

`'", "'`：替换为：双引号 + 逗号 + 空格 + 双引号

效果：将` "样本1" "样本2"` 变成 `"样本1", "样本2"`

在正则表达式中，`\s` 是一个特殊的元字符，表示：

任意空白字符，包括空格、制表符`（\t）`、换行符`（\n）`、回车符`（\r）`等。
✅ 举个例子：
```python
import re

text = "Hello\tWorld\nPython  Regex"
matches = re.findall(r'\s', text)
print(matches)
```
输出：

```Code
['\t', '\n', ' ', ' ']
```
说明` \s` 匹配了：

一个制表符` \t`

一个换行符 `\n`

两个空格 `' '`

```python
print(result)

```
解释：打印替换后的结果，显示所有样本名称现在用逗号分隔。

```python
df.columns = result  #重命名列

```
解释：这行代码有问题！

result 是一个字符串，包含所有列名和引号、逗号

df.columns 应该是一个列表，而不是一个长字符串

这样赋值会导致DataFrame的所有列名都变成这个长字符串

正确的做法应该是：
```python
import re

input_string = '''"Donor1_IVD1_AF" "Donor1_IVD1_NP" "Donor1_IVD2_AF" "Donor1_IVD2_NP" "Donor2_IVD1_AF" "Donor2_IVD1_NP" "Donor2_IVD2_AF" "Donor2_IVD2_NP" "Donor3_IVD1_AF" "Donor3_IVD1_NP" "Donor3_IVD2_AF" "Donor3_IVD2_NP" "Donor4_IVD1_AF" "Donor4_IVD1_NP" "Donor4_IVD2_AF" "Donor4_IVD2_NP" "Donor5_IVD1_AF" "Donor5_IVD1_NP" "Donor5_IVD2_AF" "Donor5_IVD2_NP" "Donor6_IVD1_AF" "Donor6_IVD1_NP" "Donor6_IVD2_AF" "Donor6_IVD2_NP" "Donor7_IVD1_AF" "Donor7_IVD1_NP" "Donor8_IVD1_AF" "Donor8_IVD1_NP" "Donor9_IVD1_AF" "Donor9_IVD1_NP" "Donor11_IVD1_AF" "Donor11_IVD1_NP" "Donor70_IVD1_NP" "Donor70_IVD1_AF" "Donor81_IVD1_AF" "Donor81_IVD1_NP" "Donor100_IVD1_NP" "Donor100_IVD1_AF" "Donor106_IVD1_NP" "Donor106_IVD1_AF" "Donor136_IVD1_NP" "Donor136_IVD1_AF" "Donor147_IVD1_NP" "Donor147_IVD1_AF" "Donor172_IVD1_NP" "Donor172_IVD1_AF" "Donor246_IVD1_NP" "Donor246_IVD1_AF"'''

# 方法1：直接提取列名（推荐）
new_columns = re.findall(r'"([^"]*)"', input_string)

# 方法2：或者先添加逗号，然后分割（效果相同）
result = re.sub(r'"\s+"', '", "', input_string)
new_columns = [col.strip('"') for col in result.split(', ')]

print("新列名列表:")
print(new_columns)

# 正确的重命名方式
df.columns = new_columns
```
原代码的问题：
`df.columns = result` 会导致：

DataFrame只有1列（因为result是一个字符串）

该列的名称是整个长字符串

完全不是想要的重命名效果

正确的输出应该是：
新列名列表是一个包含48个独立字符串的列表：

```python
['Donor1_IVD1_AF', 'Donor1_IVD1_NP', 'Donor1_IVD2_AF', 'Donor1_IVD2_NP', ...]
```
而不是一个长字符串：

```python
'"Donor1_IVD1_AF", "Donor1_IVD1_NP", "Donor1_IVD2_AF", "Donor1_IVD2_NP", ...'
```
所以应该使用 re.findall() 直接提取所有列名，或者将替换后的字符串分割成列表。

---
用文本编辑器的方法
方法：使用文本编辑器正则表达式
在`VS Code`、`Sublime Text`等编辑器中，可以使用以下正则表达式：

查找： `"\s+"`
替换： `", "`

---

方法：使用在线正则表达式工具
在 `https://regex101.com/` 或其他在线工具中：

输入模式：`"\s+"`

替换为：`", "`

---
## 进一步简化列名，比如说只保留组织名
```python
input_string = '''"Donor1_IVD1_AF" "Donor1_IVD1_NP" "Donor1_IVD2_AF" "Donor1_IVD2_NP" "Donor2_IVD1_AF"
"Donor2_IVD1_NP" "Donor2_IVD2_AF" "Donor2_IVD2_NP" "Donor3_IVD1_AF" "Donor3_IVD1_NP" "Donor3_IVD2_AF"
"Donor3_IVD2_NP" "Donor4_IVD1_AF" "Donor4_IVD1_NP" "Donor4_IVD2_AF" "Donor4_IVD2_NP" "Donor5_IVD1_AF"
"Donor5_IVD1_NP" "Donor5_IVD2_AF" "Donor5_IVD2_NP" "Donor6_IVD1_AF" "Donor6_IVD1_NP" "Donor6_IVD2_AF"
"Donor6_IVD2_NP" "Donor7_IVD1_AF" "Donor7_IVD1_NP" "Donor8_IVD1_AF" "Donor8_IVD1_NP" "Donor9_IVD1_AF"
"Donor9_IVD1_NP" "Donor11_IVD1_AF" "Donor11_IVD1_NP" "Donor70_IVD1_NP" "Donor70_IVD1_AF" "Donor81_IVD1_AF"
"Donor81_IVD1_NP" "Donor100_IVD1_NP" "Donor100_IVD1_AF" "Donor106_IVD1_NP" "Donor106_IVD1_AF"
"Donor136_IVD1_NP" "Donor136_IVD1_AF" "Donor147_IVD1_NP" "Donor147_IVD1_AF" "Donor172_IVD1_NP"
"Donor172_IVD1_AF" "Donor246_IVD1_NP" "Donor246_IVD1_AF"'''

tissue_types = re.findall(r'(AF|NP)',input_string)
tissue_types
```

---
使用vs code的文本功能对列表进行正则表达式操作
1. 打开查找和替换面板
快捷键：Ctrl + F（查找）或 Ctrl + H（替换）

菜单：Edit → Find → Replace

2. 启用正则表达式模式
点击查找框右侧的 .* 图标（或按 Alt + R）来启用正则表达式模式。

https://code.visualstudio.com/assets/docs/editor/codebasics_search-regex.png

3. 常用正则表达式示例
示例1：在单词之间添加逗号（您需要的）
查找：`"\s+"`

替换：`", "`

效果：`"word1" "word2"` →` "word1", "word2"`

示例2：删除空行
查找：`^\s*$\n`

替换：（留空）

效果：删除所有空行

---
1. 提取并保留特定字符
示例：提取所有Donor编号
查找：Donor(\d+)

替换：$1 （只保留数字部分）

效果：Donor123_AF → 123

在例如提取AF组织
1.输入`(Donor\d+_IVD\d+_AF)`
2.输入`AF`
3.replace all
